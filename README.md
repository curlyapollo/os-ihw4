# Карлинский Леонид Вадимович, БПИ216
## Вариант №32
## Условие задачи:
Вторая задача об Острове Сокровищ. Шайка пиратов под
предводительством Джона Сильвера высадилась на берег Острова
Сокровищ. Не смотря на добытую карту старого Флинта, местоположение сокровищ по-прежнему остается загадкой, поэтому искать
клад приходится практически на ощупь. Так как Сильвер ходит на
деревянной ноге, то самому бродить по джунглям ему не с руки.
Джон Сильвер поделил остров на участки, а пиратов на небольшие группы. Каждой группе поручается искать клад на нескольких
участках, а сам Сильвер ждет на берегу. Группа пиратов, обшарив
один участок, переходит на следующий, еще необследованный. Закончив поиски, пираты возвращаются к Сильверу и докладывают
о результатах. Если какая–то из групп находит клад на одном из
своих участков, она возвращается к Сильверу, который шлет попугая, инициализирующего прекращение (прерывание) всех работ.
Требуется создать приложение, моделирующее действия Сильвера и пиратов.Сервер — Сильвер, Каждая из групп пиратов — клиент.

## Работа выполнена на 8 баллов
Везде даны комментарии на английском, поясняющие работу программы.
Для обеспечения корректного взаимодействия сетевых приложений
и существующих в них процессов используются мьютексы.

Даны 3 папки, в каждой лежит решение на оценку, на которую называется папка. Теперь схемы:
## на 5:
Программа pirates.c является клиентской программой,  которая использует протокол UDP для связи с сервером. Программа принимает два аргумента при запуске - IP-адрес сервера и порт, на котором сервер ожидает подключения. 

Функция checkArguments() проверяет правильность количества аргументов. Если количество аргументов не равно 3, то выводится сообщение об ошибке и программа завершается.

Далее создается клиентский сокет с помощью функции socket(). Если создание сокета прошло успешно, то создается структура адреса сервера и заполняется необходимая информация (IP-адрес и порт). 

Затем отправляется первое сообщение на сервер с помощью функции sendto(). В цикле while(1) происходит прием и отправка сообщений между клиентом и сервером. Если в сообщении от сервера значение taken[0] равно -1, то цикл прерывается. 

Внутри цикла происходит "сканирование" секторов (вызов функции sleep() с рандомным временем) и проверка на наличие "сокровища". Если сокровище найдено, то клиент отправляет сообщение на сервер с помощью функции sendto() и заканчивает выполнение. Если сокровище не найдено, то клиент отправляет сообщение с информацией о том, что сокровище не найдено.

После выполнения цикла выводится сообщение о завершении поиска и закрывается клиентский сокет.
_____________________________________________________________________________________________________________________________________________
Программа silver.c является серверной программой, которая имитирует поиск сокровища пиратами. В начале определены необходимые библиотеки и константа для максимального количества ожидающих запросов на соединение.

Основная функция этой программы настраивает UDP-серверный сокет и создает несколько потоков для имитации пиратов, ищущих сокровище в разных областях. Программа принимает четыре аргумента командной строки: порт клиента, количество областей для поиска, область с сокровищем и количество пиратов.

Сначала программа инициализирует мьютекс и проверяет аргументы командной строки. Затем она выделяет память для двух массивов: областей и пиратов. Массив областей представляет различные области, которые могут искать пираты, со значением 0, указывающим на неисследованную область, 1, указывающим на исследованную область без сокровищ, и 2, указывающим на область с сокровищами. Массив пиратов представляет собой самих пиратов, каждый элемент которого представляет текущее местоположение пирата (инициализированное значением -1, чтобы указать, что они еще не начали поиск).

Затем программа создает серверный сокет и связывает его с указанным портом. Затем она создает поток для каждого пирата, передавая в функцию потока структуру, содержащую серверный сокет и количество областей в качестве аргументов.

Функция потока, piratesProcess, отвечает за имитацию поиска пирата за сокровищами. Она использует цикл while для повторного поиска неисследованных областей, пока не найдет сокровища или все области не будут исследованы. Если он находит сокровища, он устанавливает свое текущее местоположение в области с сокровищами и отправляет сообщение на сервер, указывающее на успех. Если все области были исследованы, и сокровища не были найдены, он отправляет сообщение, указывающее на неудачу.

Основная функция также содержит бесконечный цикл, чтобы программа продолжала работать до тех пор, пока ее не остановят вручную. Наконец, она освобождает выделенную память и уничтожает мьютекс перед выходом.

## На 8: 
Добавлен новый функционал, позволяющий клиентам-слушателям получать информацию о состоянии секторов. Каждый сектор имеет свое значение: 0 - неисследованный, 1 - исследованный, 2 - сектор с сокровищами. Клиенты-слушатели могут подключаться к серверу и получать информацию о состоянии секторов одновременно. Слушатель отключается при получении сигнала SIGINT или при нахождении клиентом клада. Сервер также отключается при получении сигнала SIGINT или при нахождении клиентом клада. Для корректной работы multicast адрес сервера и клиента-слушателя должен быть 224.0.0.1, а для обычного клиента - 127.0.0.1.


### ВСЁ!!!
